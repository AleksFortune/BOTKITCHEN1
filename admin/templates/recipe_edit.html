{% extends "base.html" %}

{% block title %}{% if recipe %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ{% else %}–ù–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç{% endif %} - MealBot Admin{% endblock %}

{% block content %}
<div class="admin-layout">
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>üçΩÔ∏è <span>MealBot</span></h2>
        </div>
        <nav class="sidebar-nav">
            <a href="/admin" class="nav-item">
                <i class="fas fa-home nav-icon"></i>
                Dashboard
            </a>
            <a href="/admin/users" class="nav-item">
                <i class="fas fa-users nav-icon"></i>
                –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
            </a>
            <a href="/admin/recipes" class="nav-item active">
                <i class="fas fa-utensils nav-icon"></i>
                –†–µ—Ü–µ–ø—Ç—ã
            </a>
            <div style="margin-top: auto; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1rem;">
                <a href="/admin/logout" class="nav-item" style="color: var(--danger);">
                    <i class="fas fa-sign-out-alt nav-icon"></i>
                    –í—ã—Ö–æ–¥
                </a>
            </div>
        </nav>
    </aside>

    <main class="main-content">
        <div class="top-bar">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <a href="{% if recipe %}/admin/recipes/{{ recipe.id }}{% else %}/admin/recipes{% endif %}" class="btn btn-secondary btn-sm">
                    <i class="fas fa-arrow-left"></i>
                    –ù–∞–∑–∞–¥
                </a>
                <h1>{% if recipe %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞{% else %}–ù–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç{% endif %}</h1>
            </div>
            <div class="user-menu">
                <span style="color: var(--secondary);">{{ admin }}</span>
                <div style="width: 32px; height: 32px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">
                    {{ admin[0].upper() }}
                </div>
            </div>
        </div>

        <form method="POST" action="/admin/recipes/save">
            {% if recipe %}
            <input type="hidden" name="id" value="{{ recipe.id }}">
            {% endif %}

            <!-- Basic Info -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                </div>

                <div class="grid-3">
                    <div class="form-group">
                        <label class="form-label">–î–µ–Ω—å –ø—Ä–æ–≥—Ä–∞–º–º—ã *</label>
                        <input type="number" name="day_number" class="form-input" min="1" max="30" value="{{ recipe.day_number if recipe else '1' }}" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">–ü—Ä–∏—ë–º –ø–∏—â–∏ *</label>
                        <select name="meal_type" class="form-select" required>
                            {% for mt in meal_types %}
                            <option value="{{ mt }}" {% if recipe and recipe.meal_type == mt %}selected{% endif %} style="text-transform: capitalize;">
                                {{ mt }}
                            </option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">–í—Ä–µ–º—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è (–º–∏–Ω)</label>
                        <input type="number" name="cooking_time" class="form-input" min="1" value="{{ recipe.cooking_time if recipe else '' }}">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞ *</label>
                    <input type="text" name="title" class="form-input" placeholder="üåÖ –ó–ê–í–¢–†–ê–ö –î–ï–ù–¨ X: –ù–∞–∑–≤–∞–Ω–∏–µ –±–ª—é–¥–∞" value="{{ recipe.title if recipe else '' }}" required>
                    <small style="color: var(--secondary);">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–º–æ–¥–∑–∏ –∏ —Ñ–æ—Ä–º–∞—Ç: 'üåÖ –ó–ê–í–¢–†–ê–ö –î–ï–ù–¨ X: –ù–∞–∑–≤–∞–Ω–∏–µ'</small>
                </div>

                <div class="form-group">
                    <label class="form-label">–ü—Ä–µ–º–∏—É–º —Ä–µ—Ü–µ–ø—Ç</label>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <input type="checkbox" name="is_premium" id="is_premium" value="true" {% if recipe and recipe.is_premium %}checked{% endif %} style="width: 20px; height: 20px;">
                        <label for="is_premium" style="margin: 0; cursor: pointer;">–î–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ (–¥–Ω–∏ 8-30)</label>
                    </div>
                </div>
            </div>

            <!-- Content -->
            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üì¶ –°–ø–∏—Å–æ–∫ –∑–∞–∫—É–ø–æ–∫</h3>
                    </div>
                    <div class="form-group" style="margin: 0;">
                        <textarea name="shopping" class="form-textarea" rows="12" placeholder="üì¶ –ù–ê –ó–ê–ö–£–ü–ö–£ (–Ω–∞ 2 —á–µ–ª–æ–≤–µ–∫–∞):
‚Ä¢ –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç 1
‚Ä¢ –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç 2" required>{{ recipe.shopping if recipe else '' }}</textarea>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üçΩÔ∏è –ü–æ—Ä—Ü–∏—è –Ω–∞ —á–µ–ª–æ–≤–µ–∫–∞</h3>
                    </div>
                    <div class="form-group" style="margin: 0;">
                        <textarea name="portion" class="form-textarea" rows="12" placeholder="üçΩ –ù–ê –ü–û–†–¶–ò–Æ (1 —á–µ–ª–æ–≤–µ–∫):
‚Ä¢ –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç 1
‚Ä¢ –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç 2" required>{{ recipe.portion if recipe else '' }}</textarea>
                    </div>
                </div>
            </div>

            <!-- Recipe Instructions -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">üìù –ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ</h3>
                </div>
                <div class="form-group" style="margin: 0;">
                    <textarea name="recipe" class="form-textarea" rows="15" placeholder="üìù –ü–†–ò–ì–û–¢–û–í–õ–ï–ù–ò–ï:
1. –®–∞–≥ –ø–µ—Ä–≤—ã–π
2. –®–∞–≥ –≤—Ç–æ—Ä–æ–π
3. ..." required>{{ recipe.recipe if recipe else '' }}</textarea>
                    <small style="color: var(--secondary);">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–º–æ–¥–∑–∏ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏: üìù üì¶ üî• ‚è±Ô∏è</small>
                </div>
            </div>

            <!-- Nutrition -->
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">üî• –ü–∏—â–µ–≤–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å</h3>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label class="form-label">–¢–µ–∫—Å—Ç –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏ *</label>
                        <input type="text" name="calories_text" class="form-input" placeholder="üî• –ö–ê–õ–û–†–ò–ô–ù–û–°–¢–¨: 550 –∫–∫–∞–ª –Ω–∞ –ø–æ—Ä—Ü–∏—é" value="{{ recipe.calories_text if recipe else '' }}" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">–ö–∞–ª–æ—Ä–∏–∏ (—á–∏—Å–ª–æ) *</label>
                        <input type="number" name="calories_value" class="form-input" placeholder="550" value="{{ recipe.calories_value if recipe else '' }}" required>
                    </div>
                </div>

                <div class="grid-3">
                    <div class="form-group">
                        <label class="form-label">–ë–µ–ª–∫–∏ (–≥)</label>
                        <input type="number" name="proteins" class="form-input" step="0.1" value="{{ recipe.proteins if recipe else '' }}">
                    </div>

                    <div class="form-group">
                        <label class="form-label">–ñ–∏—Ä—ã (–≥)</label>
                        <input type="number" name="fats" class="form-input" step="0.1" value="{{ recipe.fats if recipe else '' }}">
                    </div>

                    <div class="form-group">
                        <label class="form-label">–£–≥–ª–µ–≤–æ–¥—ã (–≥)</label>
                        <input type="number" name="carbs" class="form-input" step="0.1" value="{{ recipe.carbs if recipe else '' }}">
                    </div>
                </div>
            </div>

            <!-- Submit -->
            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                <a href="{% if recipe %}/admin/recipes/{{ recipe.id }}{% else %}/admin/recipes{% endif %}" class="btn btn-secondary">
                    <i class="fas fa-times"></i>
                    –û—Ç–º–µ–Ω–∞
                </a>
                <button type="submit" class="btn btn-success" style="padding: 0.75rem 2rem;">
                    <i class="fas fa-save"></i>
                    {% if recipe %}–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è{% else %}–°–æ–∑–¥–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç{% endif %}
                </button>
            </div>
        </form>
    </main>
</div>
{% endblock %}